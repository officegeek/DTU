---
layout: default
title: Online 17-03-2022
nav_order: 3
parent: Database
published: true
---
[HOME](../README.md)

# Online - 17-03-2022
Denne online undervisnings gang har fokus på forbindelsen mellem Excel og databaser. Hvis det er muligt er det en klar fordel at have data på en SQL server, det kan være:

- Microsoft SQL Server
- MySQL
- Oracle
- Eller ...

Excel kan oprette forbindelse til de fleste SQL servere

[](./image/Excel_Database_0.jpg)

### Excel fil
Jeg har oprettet en demo Excel fil du kan hente, men jeg vil anbefale dig selv at oprette de forskellige forbindelser osv.

![Online_17032022.xlsx](../filer/Online_17032022.xlsx)

## Opret forbindelse
Jeg brugere en MySQL database server der er hostede hos Microsoft Azure.

### Login info
For at få forbindelse skal du bruge følgende:

- Server name: **test-tueh.mysql.database.azure.com**
- Login name: **dtu**
- Password: *udleveres i undervisningen*

Det er relativt simpelt at forbinde Excel med databasen.

dfg
[](./image/Excel_Database_1.jpg)

dfg
[](./image/Excel_Database_2.jpg)

dfg
[](./image/Excel_Database_3.jpg)

dfg
[](./image/Excel_Database_4.jpg)

dfg
[](./image/Excel_Database_5.jpg)

dfg
[](./image/Excel_Database_6.jpg)

## Relationer
Der skal oprettes *relationer* imellem de 11 tabeller. Der er flere forskellige måder disse relationer kan oprettes på. Den nemmeste efter min mening er:

- Data
- Data Tools
- Power Pivot - *Et nyt vindue bliver åbnet*

[](./image/Excel_Database_7.jpg)

Her skal du vælge **Diagram View**. Dette vindue giver mulighed fro at trække de forskellige relationer.

Træk fra den tabel der har *Primær nøglen* til den tabel der hra fremmede nøglen - f.eks. Feltet **CustomerID** fra **customers** til **orders**

[](./image/Excel_Database_8.jpg)

Når alle relationer er oprettet lukkes vinduet og du kommer retur til Excel.

En anden måde at oprette relationer på er via - **Data** > **Data Tools** > **Relationships**. Her skal du skrive hver relation ind, hvilket gør at jeg syntes bedre om at gøre det via **Power Pivot**.

[](./image/Excel_Database_9.jpg)

## Ekstra felter
Når du har hentet data er det muligt at tilføje ekstra felter. Det kan f.eks. være **TotalSale** som er **Quantity** gange **UnitPrice**

- Åben Power Pivot vinduer
    - Gøres enten under fanen **Power Pivot** eller under **Data**
- Vælg tabellen **order_details**
- Klik på **Add Column**
- Klik i *formel linjen*
- Vælg kolonnerne UnitPrice og Quantity, så du får formlen:
    - ='northwind order_details'[UnitPrice]*'northwind order_details'[Quantity]
- Højre klik på den *nye* kolonne og vælg **Rename** - Giv den navnet **TotalSales**
- Gem og gå tilbage til Excel
- Under *Data* fanen klikker du på **Refresh All**

## Oprettelses af Pivot Tabeller
Nå der er oprettet relationer imellem de forskellige tabeller er det muligt at brugere data fra de forskellige tabeller ved oprettelsen af Pivot Tabeller.


### Salg fordelt på categories
- Åben Queries & Connections - *hvis den ikke allerede er åben - Gøres under Data*
- Højre klik på en af de tabeller du vil hente data fra - *categories*
- Klik på **Load to**
- Vælg **PivotTable
- Klik **Ok**
- Træk **CategoryName** ned i *Rows*
- Vælg **All* i toppen, så du kan se alle tabeller
- Fra **order_details** trækker du **TotalSales** ned i *Values*

[](./image/Excel_Database_10.jpg)

Du har nu den totale omsætning for hver af den 8 forskellige produkt kategorier. Data er hentet fra tabellerne **categories** og **order_details** via **products**. Dette er kun muligt fordi der er oprettet relationer imellem disse tabeller.






